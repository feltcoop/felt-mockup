<script>
	export let value = '';
	export let el;
	export let submit;
	export let classes = '';
	export let placeholder = '• • •';

	const onKeyDown = e => {
		switch (e.key) {
			case 'Enter': {
				if (!submit || e.shiftKey) break;
				const v = value.endsWith('\n')
					? value.slice(0, -1).trim()
					: value.trim();
				if (!v) {
					e.stopPropagation();
					e.preventDefault();
					break;
				}
				submit(v, e);
				e.stopPropagation();
				e.preventDefault();
			}
		}
	};
</script>

<textarea
	class="w-full border-4 border-purple-200 {classes} focus:outline-none
	focus:border-green-300"
	bind:value
	bind:this={el}
	on:keydown={onKeyDown}
	{placeholder} />
